---
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "yossarian-go.fullname" . }}-secrets
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "yossarian-go.labels" . | nindent 4 }}
type: Opaque
stringData:
  # Admin password
  ADMIN_PASSWORD: {{ .Values.auth.adminPassword | quote }}
  
  # OIDC configuration
  {{- if .Values.oidc.enabled }}
  OIDC_ENABLED: "true"
  OIDC_ISSUER_URL: {{ .Values.oidc.issuerURL | quote }}
  OIDC_CLIENT_ID: {{ .Values.oidc.clientID | quote }}
  OIDC_CLIENT_SECRET: {{ .Values.oidc.clientSecret | quote }}
  OIDC_REDIRECT_URL: {{ .Values.oidc.redirectURL | quote }}
  AUTO_SSO_ENABLED: {{ .Values.oidc.autoSSO | quote }}
  {{- else }}
  OIDC_ENABLED: "false"
  {{- end }}
  
  # LDAP configuration
  {{- if .Values.ldap.enabled }}
  LDAP_SERVER: {{ .Values.ldap.server | quote }}
  LDAP_BIND_DN: {{ .Values.ldap.bindDN | quote }}
  LDAP_BIND_PASSWORD: {{ .Values.ldap.bindPassword | quote }}
  LDAP_SEARCH_BASE: {{ .Values.ldap.searchBase | quote }}
  LDAP_SYNC_INTERVAL: {{ .Values.ldap.syncInterval | quote }}
  {{- if .Values.ldap.caCert }}
  DC_CA_CERT_PATH: "/etc/ssl/certs/ca-bundle.crt"
  {{- end }}
  {{- end }}

---
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "yossarian-go.fullname" . }}-minio-secret
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "yossarian-go.labels" . | nindent 4 }}
type: Opaque
stringData:
  password: {{ include "yossarian-go.minioSecretKey" . | quote }}
