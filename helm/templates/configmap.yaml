---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "yossarian-go.fullname" . }}-config
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "yossarian-go.labels" . | nindent 4 }}
data:
  # File upload limits
  MAX_TOTAL_UPLOAD_SIZE_MB: {{ .Values.limits.maxTotalUploadSizeMB | quote }}
  MAX_FILE_SIZE_MB: {{ .Values.limits.maxFileSizeMB | quote }}
  MAX_ZIP_FILE_SIZE_MB: {{ .Values.limits.maxZipFileSizeMB | quote }}
  MAX_FILE_COUNT: {{ .Values.limits.maxFileCount | quote }}
  
  # Domain configuration
  {{- if .Values.domain.netbios }}
  DOMAIN_NETBIOS: {{ .Values.domain.netbios | quote }}
  {{- end }}
  {{- if .Values.domain.fqdn }}
  DOMAIN_FQDN: {{ .Values.domain.fqdn | quote }}
  {{- end }}
  
  # Organization settings
  {{- if .Values.organization.sensitiveTerms }}
  SENSITIVE_TERMS: {{ .Values.organization.sensitiveTerms | quote }}
  {{- end }}
  {{- if .Values.organization.serverPrefixes }}
  SERVER_PREFIXES: {{ .Values.organization.serverPrefixes | quote }}
  {{- end }}

{{- if .Values.customCA.enabled }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "yossarian-go.fullname" . }}-ca-bundle
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "yossarian-go.labels" . | nindent 4 }}
data:
  ca-bundle.crt: |
{{ .Values.customCA.certificate | indent 4 }}
{{- end }}
